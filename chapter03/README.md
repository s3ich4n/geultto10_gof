# 생성 패턴

생성 패턴은 초기화 프로세스를 추상화한 것이다. 이를 통해 시스템의 객체들이 생성되고, 구성되고, 표현되는 일련의 행위를 독립적으로 구성할 수 있다. 클래스 생성 패턴은 상속을 사용해서 인스턴스화 되는 클래스를 바꾸지만, 객체 생성 패턴은 인스턴스화를 다른 객체에 위임한다.

생성패턴은 시스템이 클래스 상속보다 객체 구성에 더 의존하도록 변할 때 적합하다.

- 고정된 동작 집합을 하드코딩하는 것에서
- 더 복잡한 동작으로 구성할 수 있는 "작은 기본동작 집합"을 정의하는 방식으로 변한다.

즉 특정 동작을 가진 객체를 만들려면 클래스를 인스턴스화하는 것 이상의 작업이 필요하다.

생성패턴에는 두 가지 반복되는 주제가 있다:

1. 시스템이 사용하려는 구체 클래스(_concrete class_)에 대한 지식을 캡슐화함
2. 클래스의 인스턴스의 구체적 생성, 조합이 숨겨져있음

시스템 전체가 객체에 대해 아는 것은 추상클래스에 의해 정의된 인터페이스 뿐 - 이렇기 때문에 생성 대상, 생성자, 생성 방법, 생성 시기를 유연하게 결정할 수 있다. 이를 통해 구조와 기능이 다양한 "제품(product)" 객체로 시스템을 구성할 수 있다. 이러한 구성은 컴파일 타임에 지정하거나 런타임에 지정할 수 있다.

생성패턴은 경쟁관계에 있을 수도 있다:

- 프로토타입 패턴
    - 런타임에 동적으로 객체 타입을 결정해야 할 때
    - 객체의 상태를 복제하는 것이 중요할 때
    - 새로운 객체를 만드는 비용이 큰 경우
    - 클래스의 수를 줄이고 싶을 때
- 추상 팩토리 패턴
    - 객체 생성 로직이 복잡하고 여러 단계가 필요할 때
    - 객체들 간의 일관성이 매우 중요할 때
    - 새로운 제품군을 추가하는 것이 주된 변경사항일 때

미로 게임에서:

- 사용자가 직접 미로 요소를 커스터마이즈하고 그것을 템플릿으로 저장해서 재사용하고 싶다면 → 프로토타입
- 미리 정의된 여러 테마(현대, 중세, 미래 등)의 미로를 일관성 있게 만들고 싶다면 → 추상 팩토리

아니면 상호보완적인 관계일 수도 있다:

- 빌더 + 추상 팩토리 조합:
    - 빌더는 복잡한 객체 생성 프로세스를 관리
    - 추상 팩토리는 구체적인 부품 생성을 담당
    - 결과적으로 생성 로직과 부품의 변형을 깔끔하게 분리
- 프로토타입 + 싱글턴 조합:
    - 프로토타입 레지스트리를 전역적으로 단일 인스턴스로 관리
    - 메모리 효율성 향상
    - 프로토타입 관리의 중앙화로 일관성 보장

# 책이 제시하는 예시 - 미로 게임

## 기본 구조

1. 핵심 추상 클래스
    - `MapSite`: 모든 미로 구성요소의 기본 추상 클래스
    - `.enter()`: 모든 구성요소가 구현해야 하는 추상 메서드
1. 구체 클래스들 (`MapSite`의 하위 클래스)
    - `Room`: 방 번호와 4개의 면을 가짐
    - `Wall`: 진입 불가능한 면
    - `Door`: 두 방을 연결, 열림/닫힘 상태 가짐
1. 보조 클래스들
    - `Direction`: 방향을 나타내는 `Enum` 타입 (NORTH, SOUTH, EAST, WEST)
    - `Maze`: 방들의 컬렉션을 관리
    - `MazeGame`: 미로 생성을 담당

## 현재 문제점
현재 `MazeGame.create_maze()` 는:
1. 구체 클래스들을 직접 인스턴스화 (하드코딩)
1. 미로 레이아웃이 고정됨
1. 새로운 타입의 방/문/벽을 추가하기 어려움

## 해결방안

- Factory Method:
    - 가상 함수를 통한 객체 생성
    - MazeGame의 하위 클래스에서 생성 메서드 재정의 가능
- Abstract Factory:
    - 객체 생성을 전담하는 팩토리 객체를 매개변수로 전달
    - 다른 팩토리 객체를 전달하여 다른 종류의 미로 구성요소 생성
- Builder:
    - 미로 생성 과정을 별도 객체로 캡슐화
    - 생성 과정은 동일하게 유지하면서 결과물을 다양화 가능
- Prototype:
    - 프로토타입 객체들을 복제하여 미로 구성
    - 프로토타입만 교체하여 미로 구성 변경 가능

요약은 해봤으니, 실제 코드로 살펴보는 일만 남았다!